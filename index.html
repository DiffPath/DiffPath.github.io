<!doctype html>
<head>
	
	<title>DiffPath Alpha</title>
	<link rel="stylesheet" href="http://cdn.webix.io/1.7/webix.css" type="text/css" media="screen" />
	<script src="js/webix.js" type="text/javascript"></script>
	<script src="js/testdata.js" type="text/javascript"></script>
	
</head>


<body>
  
  <div id="box" style="width:100%;height:600px;"></div>
  
  <script type="text/javascript" charset="utf-8">
    		var tabbar1 = {
      id: "tabs1",
		  view: "tabbar",
      type: "bottom",
		  selected: 'listView',
		  multiview: true,
      tabMinWidth: 150,
		  options: [{
		    value: 'Diseases',
		    id: 'listView'
		  }, {
		    value: 'Disease Info      ',
		    id: 'formView',
		    close: true
		  }, {
		    value: 'About',
		    id: 'aboutView',
		    close: true
		  }]
		};
    
    	var tabbar2 = {
      id: "tabs2",
		  view: "tabbar",
      type: "bottom",
		  selected: 'editView',
		  multiview: true,
      tabMinWidth: 150,
		  options: [{
		    value: 'Edit Data',
		    id: 'editView'
		  }, {
		    value: 'DiffPath',
		    id: 'diffView'
		  }]
		};

		var data1 = {
		  animate: true,
      id: "views1",
		  cells: [{
		    id: "listView",
		    view: "datatable",
		    select: true,
        navigation: true,
		    editable: true,
		    editaction: "custom",
        on:{
							onItemDblClick:open_new_tab
				},
		    columns: [{
		      id: "rank",
		      header: "",
		      width: 50
		    }, {
		      id: "disease",
		      header: "Disease",
		      editor: "text",
		      sort: "string",
		      fillspace: true
		    }, {
		      id: "organ",
		      header: "Organ",
          sort:"string",
		      fillspace: true
		    }, {
		      id: "prevalence",
		      header: "Prevalence",
		      fillspace: true
		    }],
		    data: [{
		      id: 1,
		      disease: "Glioblastoma Multiforme",
		      organ: "Brain",
          prevalence: "0.001",		      
		      rank: 1
		    }, {
		      id: 2,
		      disease: "Astrocytoma",
		      organ: "Brain",
		      prevalence: "0.003",
		      rank: 2
		    }]
		  }, {
		    id: "formView",
		    view: "list",
		    template: "#rank#. #title# <div style='padding-left:18px'> Year:#year#, votes:#votes# </div>",
		    type: {
		      height: 60
		    },
        data: big_film_set,
		    select: true,             
		  }, {
		    id: "aboutView",
		    template: "About the app"
		  }]
		};
    
    var data2 = {
		  animate: true,
      id: "views2",
      maxWidth:400,
      minWidth:200,
      height:600,
		  cells: [{
				view:"form", id:"editView", scroll:false,
				elements:[
					{ view:"text", name:"disease", label:"Disease" },
					{ view:"text", name:"organ", label:"Organ" },
					{ view:"text", name:"prevalence", label:"Prevalence" },
					{ view:"button", value:"Save", click:'$$("editView").save()' },
          { view:"button", value:"Clear"},
          { view:"button", value:"Add New"}
				]
			},{
		    id: "diffView",
				view:"form",
        scroll:false,
				elements:[{view:"search",
        placeholder:"Search..."}]
        }]
		};
   
		dtable = webix.ui({
		  container: "box",
      type:"border",
      rows: [
      {view:"template",type:"header",template:"DiffPath v. 0.1"},   
      {cols: [
      {type: "clean",
      rows: [
      	tabbar2,
        data2
        ]},
      {view:"resizer"},{
		  type: "clean",
		  rows: [
		    tabbar1,
		    data1
		  ]}
      ]}]      
		});
    
    $$('editView').bind('listView')

		webix.event(window, "resize", function() {
		  dtable.adjust();
		});
    
    webix.UIManager.addHotKey("enter", function(view){
				var pos = view.getSelectedId();
				view.edit(pos);
			}, dtable);


		function open_new_tab(id) {
		  var item = $$('listView').getItem(id);
		  //add tab
		    $$("views1").addView({
		      view: "template",
		      id: item.id,
          template: "Disease: " + item.disease + "<br>Organ: " + item.organ + "<br>Prevalence: " + item.prevalence
		    });
		    $$("tabs1").addOption({id:item.id, value:item.disease, close:true},true);
		  //or show if already added
		}

  </script>

</body>
</html>
